# ğŸ—ï¸ ç³»ç»Ÿæ¶æ„ä¸éƒ¨ç½²æŒ‡å—

## æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     äº’è”ç½‘ç”¨æˆ·                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ HTTPS (TLS 1.2+)
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Nginx åå‘ä»£ç† (80, 443)                    â”‚
â”‚  - SSLç»ˆæ­¢                                               â”‚
â”‚  - è¯·æ±‚è·¯ç”±                                              â”‚
â”‚  - é™æ€æ–‡ä»¶ç¼“å­˜                                           â”‚
â”‚  - è´Ÿè½½å‡è¡¡                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ HTTP
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Node.js Express åº”ç”¨æœåŠ¡å™¨                     â”‚
â”‚  - REST API (è®¤è¯ã€CRUD)                                â”‚
â”‚  - è¯·æ±‚éªŒè¯å’Œæˆæƒ                                        â”‚
â”‚  - ä¸šåŠ¡é€»è¾‘å¤„ç†                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ SQL
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SQLite æ•°æ®åº“                               â”‚
â”‚  - ç”¨æˆ·è´¦æˆ·æ•°æ®                                          â”‚
â”‚  - TODOé¡¹ç›®æ•°æ®                                         â”‚
â”‚  - ä¼šè¯ä¿¡æ¯                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å‰ç«¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æµè§ˆå™¨ (HTML/CSS/JavaScript)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Authentication Module              â”‚
â”‚  - ç™»å½•/æ³¨å†Œè¡¨å•                            â”‚
â”‚  - Tokenç®¡ç†                                â”‚
â”‚  - ä¼šè¯æ£€æŸ¥                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Todo Application Module            â”‚
â”‚  - ä»»åŠ¡åˆ—è¡¨ç®¡ç†                             â”‚
â”‚  - å®æ—¶æ›´æ–°                                 â”‚
â”‚  - åŒæ­¥æœºåˆ¶                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          API Client Layer                   â”‚
â”‚  - RESTful APIè°ƒç”¨                          â”‚
â”‚  - é”™è¯¯å¤„ç†                                 â”‚
â”‚  - è‡ªåŠ¨é‡è¯•                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## åç«¯APIè®¾è®¡

### è®¤è¯æµç¨‹
```
ç”¨æˆ·è¾“å…¥å‡­è¯
    â†“
POST /api/auth/login (æˆ– /register)
    â†“
æœåŠ¡å™¨éªŒè¯å‡­è¯
    â†“
ç”ŸæˆJWT Token (æœ‰æ•ˆæœŸ7å¤©)
    â†“
è¿”å›Tokenç»™å®¢æˆ·ç«¯
    â†“
å®¢æˆ·ç«¯å­˜å‚¨Token (localStorage)
    â†“
åç»­è¯·æ±‚ Header ä¸­åŒ…å« "Authorization: Bearer <token>"
    â†“
æœåŠ¡å™¨éªŒè¯Token
    â†“
è®¿é—®æˆæƒèµ„æº
```

### æ•°æ®è®¿é—®æ§åˆ¶
```
Request with Token
    â†“
Authenticate Token
    â†“
Extract User ID from Token
    â†“
Apply Data Filter (WHERE user_id = ?)
    â†“
Return Only User's Data
```

## éƒ¨ç½²æ‹“æ‰‘

### å¼€å‘ç¯å¢ƒ
```
localhost:3000
  â”œâ”€â”€ HTML/CSS/JS (é™æ€æ–‡ä»¶)
  â”œâ”€â”€ Express API
  â””â”€â”€ SQLite DB (app.db)
```

### ç”Ÿäº§ç¯å¢ƒï¼ˆDocker Composeï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Docker Host (äº‘æœåŠ¡å™¨)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚     Docker Network (todo-app)    â”‚  â”‚
â”‚  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚   Nginx     â”‚  â”‚ Node.js  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ å®¹å™¨        â”‚  â”‚ å®¹å™¨     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ :80, :443   â”‚  â”‚ :3000    â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                       â”‚           â”‚  â”‚
â”‚  â”‚                   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”     â”‚  â”‚
â”‚  â”‚                   â”‚SQLite  â”‚     â”‚  â”‚
â”‚  â”‚                   â”‚app.db  â”‚     â”‚  â”‚
â”‚  â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚  â”‚                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      æŒä¹…åŒ–æ•°æ®å·                 â”‚  â”‚
â”‚  â”‚  - app.db æ•°æ®åº“å¤‡ä»½             â”‚  â”‚
â”‚  â”‚  - SSLè¯ä¹¦                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## éƒ¨ç½²æ­¥éª¤

### 1. å‡†å¤‡æœåŠ¡å™¨
```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…Dockerå’ŒDocker Compose
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
```

### 2. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd todo-app
```

### 3. é…ç½®ç¯å¢ƒ
```bash
# åˆ›å»º .env æ–‡ä»¶
cat > .env << EOF
PORT=3000
JWT_SECRET=$(openssl rand -hex 32)
NODE_ENV=production
EOF

# åˆ›å»ºSSLè¯ä¹¦ç›®å½•
mkdir -p ssl
```

### 4. è·å–SSLè¯ä¹¦ï¼ˆä½¿ç”¨Let's Encryptï¼‰
```bash
# æ–¹æ³•1: ä½¿ç”¨Certbot
sudo apt install certbot

sudo certbot certonly --standalone \
  -d your-domain.com \
  -d www.your-domain.com

# å¤åˆ¶è¯ä¹¦åˆ°é¡¹ç›®
sudo cp /etc/letsencrypt/live/your-domain.com/fullchain.pem ssl/cert.pem
sudo cp /etc/letsencrypt/live/your-domain.com/privkey.pem ssl/key.pem
```

### 5. å¯åŠ¨æœåŠ¡
```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æ£€æŸ¥çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### 6. é…ç½®DNS
```
A record: your-domain.com -> server-ip
AAAA record: your-domain.com -> server-ipv6
```

### 7. éªŒè¯éƒ¨ç½²
```bash
# æ£€æŸ¥å¥åº·çŠ¶æ€
curl https://your-domain.com/api/health

# æµ‹è¯•æ³¨å†Œ
curl -X POST https://your-domain.com/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"username":"test","email":"test@example.com","password":"test123456"}'
```

## æ‰©å±•éƒ¨ç½²

### æ°´å¹³æ‰©å±•ï¼ˆå¤šä¸ªåº”ç”¨å®ä¾‹ï¼‰
```yaml
# docker-compose.yml ä¿®æ”¹
services:
  app1:
    build: .
    environment: ...
  
  app2:
    build: .
    environment: ...
  
  nginx:
    # upstream app è‡ªåŠ¨è´Ÿè½½å‡è¡¡åˆ° app1, app2
```

### æ•°æ®åº“æ‰©å±•
```bash
# åˆ‡æ¢åˆ°PostgreSQLï¼ˆå¯é€‰ï¼‰
# ä¿®æ”¹ server.js ä½¿ç”¨ pg é©±åŠ¨
npm install pg
```

### ç¼“å­˜å±‚ï¼ˆRedisï¼‰
```yaml
services:
  redis:
    image: redis:7-alpine
  app:
    depends_on:
      - redis
```

## ç›‘æ§å’Œç»´æŠ¤

### æ—¥å¿—ç›‘æ§
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker-compose logs app

# ç›‘æ§å®æ—¶æ—¥å¿—
docker-compose logs -f --tail=50 app

# å¯¼å‡ºæ—¥å¿—
docker-compose logs app > app.log
```

### æ€§èƒ½ç›‘æ§
```bash
# ç›‘æ§å®¹å™¨èµ„æºä½¿ç”¨
docker stats

# æ£€æŸ¥æ•°æ®åº“å¤§å°
docker-compose exec app ls -lh app.db
```

### å®šæ—¶å¤‡ä»½
```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬ backup.sh
#!/bin/bash
BACKUP_DIR="/backups/todo-app"
DATE=$(date +%Y%m%d_%H%M%S)
mkdir -p $BACKUP_DIR
docker-compose exec -T app cp app.db /tmp/app.db.${DATE}
docker cp todo-app_app_1:/tmp/app.db.${DATE} $BACKUP_DIR/

# è®¾ç½®å®šæ—¶ä»»åŠ¡
crontab -e
# æ·»åŠ : 0 2 * * * /path/to/backup.sh
```

### æ—¥å¿—è½®è½¬
```bash
# åˆ›å»º /etc/docker/daemon.json
{
  "log-driver": "json-file",
  "log-opts": {
    "max-size": "10m",
    "max-file": "3"
  }
}

systemctl reload docker
```

## æ•…éšœæ¢å¤

### å®¹å™¨å´©æºƒ
```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹å´©æºƒæ—¥å¿—
docker-compose logs app | tail -50

# é‡å¯å®¹å™¨
docker-compose restart app
```

### æ•°æ®åº“æŸå
```bash
# å¤‡ä»½æŸåçš„æ•°æ®åº“
cp app.db app.db.backup

# åˆ é™¤æ•°æ®åº“ï¼Œè®©åº”ç”¨é‡æ–°åˆ›å»º
rm app.db

# é‡å¯åº”ç”¨
docker-compose restart app
```

### ç©ºé—´ä¸è¶³
```bash
# æ¸…ç†æœªä½¿ç”¨çš„å®¹å™¨å’Œé•œåƒ
docker system prune -a

# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨
docker system df
```

## æ€§èƒ½ä¼˜åŒ–

### Nginxç¼“å­˜
```nginx
proxy_cache_path /var/cache/nginx levels=1:2 keys_zone=api_cache:10m;

location /api/ {
    proxy_cache api_cache;
    proxy_cache_valid 200 60s;
}
```

### æ•°æ®åº“ç´¢å¼•
```sql
CREATE INDEX idx_todos_user_id_created ON todos(user_id, created_at DESC);
```

### è¿æ¥æ± 
```javascript
// åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨è¿æ¥æ± 
const pool = new sqlite3.Pool();
```

## å®‰å…¨åŠ å›º

### é˜²ç«å¢™è§„åˆ™
```bash
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable
```

### å®šæœŸæ›´æ–°ä¾èµ–
```bash
npm audit fix
docker-compose pull
docker-compose up -d
```

### ç›‘æ§å¼‚å¸¸æµé‡
```bash
# åˆ†æNginxè®¿é—®æ—¥å¿—
tail -f /var/log/nginx/access.log | grep "error\|401\|403"
```

## CI/CDæµç¨‹ï¼ˆGitHub Actionsç¤ºä¾‹ï¼‰

```yaml
name: Deploy

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Build and Deploy
        run: |
          docker build -t todo-app:${{ github.sha }} .
          # æ¨é€åˆ°æ³¨å†Œè¡¨
          docker push registry.example.com/todo-app:${{ github.sha }}
          # æ›´æ–°ç”Ÿäº§ç¯å¢ƒ
          ssh user@server "cd /app && docker-compose pull && docker-compose up -d"
```
